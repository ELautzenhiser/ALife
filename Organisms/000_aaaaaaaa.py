translation = {'098': '_', '099': '.py', '126': 'initiateInteraction', '090': 'range', '091': 'choice', '092': 'makeOffspring', '093': 'locationID', '094': 'uniqueID', '095': '8', '096': 'alphanumeric', '097': 'offspringName', '133': 'Popen', '011': 'metabolism', '131': 'getMessage', '013': 'selfName', '014': 'world', '136': 'bufsize', '135': '{}={}', '134': 'python', '018': '3', '019': '{}[{}]', '127': 'organisms', '138': 'PIPE', '120': 'distance', '121': 'newName', '027': '-1', '123': 'tryToMove', '021': '{}.{}', '125': '100', '023': '0', '022': 'argv', '128': 'otherName', '129': 'interact', '029': 'getcwd', '028': '/', '010': 'global {}', '132': 'otherOrganism', '012': 'codonLength', '130': 'message', '137': 'stdin', '015': 'sightDistance', '016': '{} = {}', '084': 'chars', '017': '0.5', '089': 'string', '115': 'direction', '114': 'getNewPosition', '038': 'aacid', '116': '({} % {})', '111': 'intToString', '110': 'name', '113': '({} - {})', '112': 'num', '032': 'getTree', '033': 'position', '030': '300', '031': 'dedent', '119': 'move', '037': '({} + {})', '034': 'codon', '035': 'genome', '053': 'value', '108': 'close', '109': 'splitName', '085': 'abcdefghijklmnopqrstuvwxyz', '049': 'for {} in {}:', '048': '{{}}', '102': 'w', '046': '}}}}', '045': '{{{{', '044': 'replace', '043': 'num_subacids', '107': '\\"', '104': 'translation = ', '040': '{} += {}', '139': 'stdout', '151': 'listdir', '150': 'organism', '153': 'findNearbyOrganisms', '047': 'count', '152': '-3', '058': 'except{}:', '059': '#', '103': 'write', '054': 'append', '055': 'try:', '056': 'format', '057': '*{}', '050': 'i', '051': 'xrange', '052': '({})', '154': 'location', '101': 'open', '157': 'organismLocation', '106': 'genome = \\"', '156': '{} != {}', '145': 'parsedResponse', '042': '[{}]', '041': 'newContainer', '105': 'str', '061': 'translate', '060': 'return {}', '063': 'code_list', '062': 'output', '065': '{} < {}', '064': 'while {}:', '067': 'indent', '066': 'len', '069': 'if {}:', '068': 'line', '164': 'type', '165': 'get', '166': 'None', '167': 'print {}', '160': '{} > {}', '161': 'startConditions', '162': 'raw_input', '163': 'loads', '117': 'int', '039': 'translation', '076': '4', '077': '1', '074': '({} * {})', '075': ' ', '072': 'else:', '073': ':', '070': '{} == {}', '071': '\\n', '159': 'abs', '158': '({} or {})', '078': '{} -= {}', '079': 'max', '100': 'offspring', '036': '{}:{}', '118': '1000', '155': 'nearby', '146': 'dict', '147': 'acting_organism', '144': 'communicate', '088': '0123456789abcdefghijklmnopqrstuvwxyz', '142': 'True', '143': 'fullResponse', '140': 'stderr', '141': 'universal_newlines', '083': 'letters', '082': 'kind', '081': 'length', '080': 'getRandomString', '087': '0123456789', '086': 'numbers', '148': 'dumps', '149': 'getAllOrganisms', '003': 'random', '002': 'sys', '001': '{}, {}', '000': 'import {}', '007': '', '006': 'subprocess', '005': 'json', '004': 'os', '009': 'getTraits', '008': 'def {}({}):', '025': "'{}'", '024': 'split', '122': 'rename', '026': '\\\\', '124': 'uniform', '020': '{}({})'}
genome = '000001002001003001004001005006007008009007010011010012010013010014010015016011017016012018016013019020021019020021019021002022023024025026027024025028027016014020021004029007016015030031007008032033016034019035036033037033012016038019039034040033012016041042007016043020021020021020021038044001025045025007044001025046025007047025048049050020051043016052001053033020032033020021041054053031055016038020021038056057041031058007016038037025059038031060052001038033031007008061007016062025007016063042007016033023064065033020066035016052001053033020032033020021063054053031016067023049068063069070020066068023040062025071031072069070019068027025073040062037037025071074025075074076067068040067077031072069070068025031078067077016067020079001067023031072040062037037025071074025075074076067068031031031031060062031007008080001081082069070082025083016084025085031072069070082025086016084025087031072016084025088031031016089025007049050020090081040089020021003091084031060089031007008092007016093020080001018025086016094020080001095025096016097037037037093025098094025099016100020101001097025102020021100103037025104020105039020021100103037037037025071025106035025107020021100103020061007020021100108007031007008109110060020021110024025098031007008111001112081016112020105112049050020051113081020066112016112037025023112031060112031007008114001033115060116037020117033115118031007008119120010013016052001033094020021013024025098069065021003003017016115077031072016115027031049050020051120016033020111001020114001033115018016121037037033025098094020021004122001013121016013121031031007008123007069065020021003003007011016120020117074011020021003124001077125020119120031031007008126127016128020021003091127020129128031007008129128016130020131007016132020021006133001042001025134128001135136077001135137021006138001135139021006138001135140021006138135141142016143020021132144130016145019143023031007008131007016130020146007016019130025147013060020021005148130031007008149014016127042007049150020021004151014069070019150036152007025099020021127054150031031060127031007008153127016154020117019020109013023016155042007049150127069156150013016157020117019020109150023069158065020159113157154015160020159113157154113118015020021155054150031031031060155031020009007016161020162007055016161020021005163161031058007016161020146007031069156020164161146016161020146007031069070020021161165025147166020123007016127020149014016155020153127069155020126155031020092007031072020123007167020131007031'
import sys, random, os, json, subprocess

def getTraits():
    global metabolism
    global codonLength
    global selfName
    global world
    global sightDistance
    metabolism = 0.5
    codonLength = 3
    selfName = sys.argv[0].split('\\')[-1].split('/')[-1]
    world = os.getcwd()
    sightDistance = 300

def getTree(position):
    codon = genome[position:(position + codonLength)]
    aacid = translation[codon]
    position += codonLength
    newContainer = []
    num_subacids = aacid.replace('{{', '').replace('}}', '').count('{}')
    for i in xrange(num_subacids):
        (value, position) = getTree(position)
        newContainer.append(value)
    try:
        aacid = aacid.format(*newContainer)
    except:
        aacid = ('#' + aacid)
    return (aacid, position)

def translate():
    output = ''
    code_list = []
    position = 0
    while position < len(genome):
        (value, position) = getTree(position)
        code_list.append(value)
    indent = 0
    for line in code_list:
        if len(line) == 0:
            output += '\n'
        else:
            if line[-1] == ':':
                output += (('\n' + (' ' * (4 * indent))) + line)
                indent += 1
            else:
                if line == 'dedent':
                    indent -= 1
                    indent = max(indent, 0)
                else:
                    output += (('\n' + (' ' * (4 * indent))) + line)
    return output

def getRandomString(length, kind):
    if kind == 'letters':
        chars = 'abcdefghijklmnopqrstuvwxyz'
    else:
        if kind == 'numbers':
            chars = '0123456789'
        else:
            chars = '0123456789abcdefghijklmnopqrstuvwxyz'
    string = ''
    for i in range(length):
        string += random.choice(chars)
    return string

def makeOffspring():
    locationID = getRandomString(3, 'numbers')
    uniqueID = getRandomString(8, 'alphanumeric')
    offspringName = (((locationID + '_') + uniqueID) + '.py')
    offspring = open(offspringName, 'w')
    offspring.write(('translation = ' + str(translation)))
    offspring.write(((('\n' + 'genome = \"') + genome) + '\"'))
    offspring.write(translate())
    offspring.close()

def splitName(name):
    return name.split('_')

def intToString(num, length):
    num = str(num)
    for i in xrange((length - len(num))):
        num = ('0' + num)
    return num

def getNewPosition(position, direction):
    return ((int(position) + direction) % 1000)

def move(distance):
    global selfName
    (position, uniqueID) = selfName.split('_')
    if random.random < 0.5:
        direction = 1
    else:
        direction = -1
    for i in xrange(distance):
        position = intToString(getNewPosition(position, direction), 3)
        newName = ((position + '_') + uniqueID)
        os.rename(selfName, newName)
        selfName = newName

def tryToMove():
    if random.random() < metabolism:
        distance = int((metabolism * random.uniform(1, 100)))
        move(distance)

def initiateInteraction(organisms):
    otherName = random.choice(organisms)
    interact(otherName)

def interact(otherName):
    message = getMessage()
    otherOrganism = subprocess.Popen(['python', otherName], bufsize=1, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE, universal_newlines=True)
    fullResponse = otherOrganism.communicate(message)
    parsedResponse = fullResponse[0]

def getMessage():
    message = dict()
    message['acting_organism'] = selfName
    return json.dumps(message)

def getAllOrganisms(world):
    organisms = []
    for organism in os.listdir(world):
        if organism[-3:] == '.py':
            organisms.append(organism)
    return organisms

def findNearbyOrganisms(organisms):
    location = int(splitName(selfName)[0])
    nearby = []
    for organism in organisms:
        if organism != selfName:
            organismLocation = int(splitName(organism)[0])
            if (abs((organismLocation - location)) < sightDistance or abs((organismLocation - location)) > (1000 - sightDistance)):
                nearby.append(organism)
    return nearby
getTraits()
startConditions = raw_input()
try:
    startConditions = json.loads(startConditions)
except:
    startConditions = dict()
if type(startConditions) != dict:
    startConditions = dict()
if startConditions.get('acting_organism') == None:
    tryToMove()
    organisms = getAllOrganisms(world)
    nearby = findNearbyOrganisms(organisms)
    if nearby:
        initiateInteraction(nearby)
    makeOffspring()
else:
    tryToMove()
    print getMessage()