translation = {'098': 'child_location', '099': 'numpy', '023': '{}.{}', '090': '0123456789', '091': '0123456789abcdefghijklmnopqrstuvwxyz', '092': 'string', '127': '({} - {})', '094': 'choice', '095': 'getChildLocation', '096': 'parent_location', '097': 'int', '104': 'intToString', '132': 'new_name', '012': 'metabolism', '013': 'codon_length', '137': 'motivation', '136': 'None', '016': 'sight_distance', '134': 'tryToMove', '018': '{} = {}', '019': '20', '139': 'distance_one', '138': '{} is {}', '056': 'value', '105': 'makeOffspring', '093': 'range', '120': 'translation = ', '024': 'argv', '122': 'genome = \\"', '123': '\\"', '124': 'close', '020': '3', '126': 'num', '022': '{}({})', '128': 'getNewPosition', '129': 'distance', '113': 'offspring_name', '029': '-1', '028': '\\\\', '010': 'getTraits', '011': 'global {}', '131': 'uniqueID', '130': 'move', '014': 'self_name', '015': 'world', '135': 'end_point', '194': 'float', '017': 'neutrality', '191': 'loads', '190': 'raw_input', '193': 'other_location', '192': 'type', '115': '.py', '114': '_', '038': 'genome', '039': '{}:{}', '111': '8', '110': 'unique_id', '149': 'initiateInteraction', '112': 'alphanumeric', '032': '300', '033': '0.5', '030': '/', '031': 'getcwd', '119': 'write', '037': 'codon', '034': 'dedent', '035': 'getTree', '174': 'other_friendliness', '173': 'get', '051': '{{}}', '052': 'for {} in {}:', '170': 'determineFriendliness', '108': 'splitName', '109': 'location_id', '085': 'kind', '049': '}}}}', '048': '{{{{', '102': '({} % {})', '046': 'num_subacids', '045': '[{}]', '101': '30', '106': 'self_location', '107': 'self_unique_id', '041': 'aacid', '040': '({} + {})', '054': 'xrange', '089': 'numbers', '076': ':', '150': 'organisms', '176': 'dict', '153': 'message', '047': 'replace', '152': 'interact', '058': 'try:', '059': 'format', '179': 'getAllOrganisms', '178': 'dumps', '177': 'acting_organism', '055': '({})', '175': 'friendliness', '057': 'append', '050': 'count', '172': 'kwargs', '171': '**{}', '073': '{} == {}', '044': 'new_container', '070': 'indent', '043': '{} += {}', '071': 'line', '145': '({} and {})', '042': 'translation', '182': '-3', '183': 'findNearbyOrganisms', '180': 'organism', '181': 'listdir', '186': '{} != {}', '187': 'organism_location', '184': 'location', '185': 'nearby', '188': '({} or {})', '189': 'start_conditions', '061': 'except{}:', '060': '*{}', '063': 'return {}', '062': '#', '065': 'output', '064': 'translate', '067': 'while {}:', '066': 'code_list', '069': 'len', '068': '{} < {}', '168': 'parsed_response', '169': 'print {}', '164': 'universal_newlines', '165': 'True', '166': 'full_response', '167': 'communicate', '160': 'stdin', '161': 'PIPE', '162': 'stdout', '163': 'stderr', '117': 'open', '116': 'offspring', '103': '1000', '151': 'other_name', '077': '({} * {})', '074': '\\n', '075': 'else:', '072': 'if {}:', '154': 'getMessage', '157': 'python', '156': 'Popen', '159': 'bufsize', '158': '{}={}', '078': ' ', '079': '4', '100': 'normal', '036': 'position', '118': 'w', '053': 'i', '133': 'rename', '155': 'other_organism', '146': '{} > {}', '147': '{}{}', '144': 'stimulus_direction', '088': 'abcdefghijklmnopqrstuvwxyz', '142': 'abs', '143': 'shortest_distance', '140': 'min', '141': 'distance_two', '083': 'getRandomString', '082': 'max', '081': '{} -= {}', '080': '1', '087': 'chars', '086': 'letters', '148': '-shortest_distance', '084': 'length', '003': 'random', '002': 'sys', '001': '{}, {}', '000': 'import {}', '007': 'numpy.random', '006': 'subprocess', '005': 'json', '004': 'os', '009': 'def {}({}):', '008': '', '025': '0', '121': 'str', '027': "'{}'", '026': 'split', '021': '{}[{}]', '125': 'name'}
genome = '000001002001003001004001005001006007008009010008011012011013011014011015011016011017018012019018013020018014021022023021022023021023002024025026027028029026027030029018015022023004031008018016032018017033034008008009035036018037021038039036040036013018041021042037043036013018044045008018046022023022023022023041047001027048027008047001027049027008050027051052053022054046018055001056036022035036022023044057056034058018041022023041059060044034061008018041040027062041034063055001041036034008008009064008018065027008018066045008018036025067068036022069038018055001056036022035036022023066057056034018070025052071066072073022069071025043065027074034075072073021071029027076043065040040027074077027078077079070071043070080034075072073071027034081070080018070022082001070025034075043065040040027074077027078077079070071034034034034063065034008008009083001084085072073085027086018087027088034075072073085027089018087027090034075018087027091034034018092027008052053022093084043092022023003094087034063092034008008009095096018096022097096018098022023023099003100001096101018098102098103063022104001098020034008008009105008018055001106107022108014018109022095106018110022083001111027112018113040040040109027114110027115018116022117001113027118022023116119040027120022121042022023116119040040040027074027122038027123022023116119022064008022023116124008034008008009108125063022023125026027114034008008009104001126084018126022121126052053022054127084022069126018126040027025126034063126034008008009128001036129063102040022097036129103034008008009130129011014018055001036131022108014018036022104001022128001036129020018132040040036027114131022023004133001014132018014132034008008009134001018135136018137025072138135136018129022097022023023099003100001025012022130129034075018036022097021022108014025018139040127103022082001135036022140001135036018141022142127135036018143022140001139141072068135036018144029034075018144080034018129022097022023023099003100001077077144137012012072145146137025146022142129143072146129025018129143034075018129147148008034034022130129034034008008009149150018151022023003094150022152151034008008009152151018153022154008018155022023006156001045001027157151001158159080001158160023006161001158162023006161001158163023006161158164165018166022023155167153018168021166025169168034008008009170171172072022023172173027174018175077021172027174017034075018175022023023099003100001025080034063175034008008009154171172018153022176008018021153027177014018021153027175022170171172063022023005178153034008008009179015018150045008052180022023004181015072073021180039182008027115022023150057180034034063150034008008009183150018184022097021022108014025018185045008052180150072186180014018187022097021022108180025072188068022142127187184016146022142127187184127103016022023185057180034034034063185034008022010008018189022190008058018189022023005191189034061008018189022176008034072186022192189176018189022176008034072138022023189173027177136022134008018150022179015018185022183150072185022149185034022105008034075018155022023189173027177018193022097021022108155025018174022194022023189173027175022134001193174169022154001158155155158174174034'
import sys, random, os, json, subprocess, numpy.random

def getTraits():
    global metabolism
    global codon_length
    global self_name
    global world
    global sight_distance
    global neutrality
    metabolism = 20
    codon_length = 3
    self_name = sys.argv[0].split('\\')[-1].split('/')[-1]
    world = os.getcwd()
    sight_distance = 300
    neutrality = 0.5


def getTree(position):
    codon = genome[position:(position + codon_length)]
    aacid = translation[codon]
    position += codon_length
    new_container = []
    num_subacids = aacid.replace('{{', '').replace('}}', '').count('{}')
    for i in xrange(num_subacids):
        (value, position) = getTree(position)
        new_container.append(value)
    try:
        aacid = aacid.format(*new_container)
    except:
        aacid = ('#' + aacid)
    return (aacid, position)


def translate():
    output = ''
    code_list = []
    position = 0
    while position < len(genome):
        (value, position) = getTree(position)
        code_list.append(value)
    indent = 0
    for line in code_list:
        if len(line) == 0:
            output += '\n'
        else:
            if line[-1] == ':':
                output += (('\n' + (' ' * (4 * indent))) + line)
                indent += 1
            else:
                if line == 'dedent':
                    indent -= 1
                    indent = max(indent, 0)
                else:
                    output += (('\n' + (' ' * (4 * indent))) + line)
    return output


def getRandomString(length, kind):
    if kind == 'letters':
        chars = 'abcdefghijklmnopqrstuvwxyz'
    else:
        if kind == 'numbers':
            chars = '0123456789'
        else:
            chars = '0123456789abcdefghijklmnopqrstuvwxyz'
    string = ''
    for i in range(length):
        string += random.choice(chars)
    return string


def getChildLocation(parent_location):
    parent_location = int(parent_location)
    child_location = numpy.random.normal(parent_location, 30)
    child_location = (child_location % 1000)
    return intToString(child_location, 3)


def makeOffspring():
    (self_location, self_unique_id) = splitName(self_name)
    location_id = getChildLocation(self_location)
    unique_id = getRandomString(8, 'alphanumeric')
    offspring_name = (((location_id + '_') + unique_id) + '.py')
    offspring = open(offspring_name, 'w')
    offspring.write(('translation = ' + str(translation)))
    offspring.write(((('\n' + 'genome = \"') + genome) + '\"'))
    offspring.write(translate())
    offspring.close()


def splitName(name):
    return name.split('_')


def intToString(num, length):
    num = str(num)
    for i in xrange((length - len(num))):
        num = ('0' + num)
    return num


def getNewPosition(position, distance):
    return ((int(position) + distance) % 1000)


def move(distance):
    global self_name
    (position, uniqueID) = splitName(self_name)
    position = intToString(getNewPosition(position, distance), 3)
    new_name = ((position + '_') + uniqueID)
    os.rename(self_name, new_name)
    self_name = new_name


def tryToMove(end_point = None, motivation = 0):
    if end_point is None:
        distance = int(numpy.random.normal(0, metabolism))
        move(distance)
    else:
        position = int(splitName(self_name)[0])
        distance_one = ((1000 - max(end_point, position)) + min(end_point, position))
        distance_two = abs((end_point - position))
        shortest_distance = min(distance_one, distance_two)
        if end_point < position:
            stimulus_direction = -1
        else:
            stimulus_direction = 1
        distance = int(numpy.random.normal(((stimulus_direction * motivation) * metabolism), metabolism))
        if (motivation > 0 and abs(distance) > shortest_distance):
            if distance > 0:
                distance = shortest_distance
            else:
                distance = -shortest_distance
        move(distance)


def initiateInteraction(organisms):
    other_name = random.choice(organisms)
    interact(other_name)


def interact(other_name):
    message = getMessage()
    other_organism = subprocess.Popen(['python', other_name], bufsize=1, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE, universal_newlines=True)
    full_response = other_organism.communicate(message)
    parsed_response = full_response[0]
    print parsed_response


def determineFriendliness(**kwargs):
    if kwargs.get('other_friendliness'):
        friendliness = (kwargs['other_friendliness'] * neutrality)
    else:
        friendliness = numpy.random.normal(0, 1)
    return friendliness


def getMessage(**kwargs):
    message = dict()
    message['acting_organism'] = self_name
    message['friendliness'] = determineFriendliness(**kwargs)
    return json.dumps(message)


def getAllOrganisms(world):
    organisms = []
    for organism in os.listdir(world):
        if organism[-3:] == '.py':
            organisms.append(organism)
    return organisms


def findNearbyOrganisms(organisms):
    location = int(splitName(self_name)[0])
    nearby = []
    for organism in organisms:
        if organism != self_name:
            organism_location = int(splitName(organism)[0])
            if (abs((organism_location - location)) < sight_distance or abs((organism_location - location)) > (1000 - sight_distance)):
                nearby.append(organism)
    return nearby

getTraits()
start_conditions = raw_input()
try:
    start_conditions = json.loads(start_conditions)
except:
    start_conditions = dict()
if type(start_conditions) != dict:
    start_conditions = dict()
if start_conditions.get('acting_organism') is None:
    tryToMove()
    organisms = getAllOrganisms(world)
    nearby = findNearbyOrganisms(organisms)
    if nearby:
        initiateInteraction(nearby)
    makeOffspring()
else:
    other_organism = start_conditions.get('acting_organism')
    other_location = int(splitName(other_organism)[0])
    other_friendliness = float(start_conditions.get('friendliness'))
    tryToMove(other_location, other_friendliness)
    print getMessage(other_organism=other_organism, other_friendliness=other_friendliness)