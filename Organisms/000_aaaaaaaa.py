translation = {'098': 'mutability', '099': 'chars', '023': '{}.{}', '090': 'numpy', '091': 'normal', '092': '30', '093': '({} % {})', '094': '1000', '095': 'intToString', '096': 'mutateChar', '097': 'char', '133': 'new_name', '011': 'global {}', '131': 'move', '013': 'codon_length', '137': 'None', '015': 'world', '016': 'sight_distance', '017': 'neutrality', '018': '{} = {}', '019': '20', '127': 'length', '138': 'motivation', '105': 'parent_id', '025': '0', '121': 'genome = \\"', '122': '\\"', '123': 'close', '124': 'name', '020': '3', '126': 'num', '022': '{}({})', '128': '({} - {})', '129': 'getNewPosition', '029': '-1', '028': '\\\\', '010': 'getTraits', '132': 'unique_id', '012': 'metabolism', '130': 'distance', '014': 'self_name', '136': 'end_point', '135': 'tryToMove', '134': 'rename', '195': 'other_location', '194': 'type', '178': 'dict', '191': 'start_conditions', '089': 'child_location', '193': 'loads', '192': 'raw_input', '115': 'child', '114': '.py', '038': 'genome', '039': '{}:{}', '111': 'splitName', '110': 'self_id', '113': '_', '055': '({})', '032': '300', '033': '0.5', '030': '/', '031': 'getcwd', '119': 'translation = ', '037': 'codon', '034': 'dedent', '035': 'getTree', '057': 'append', '173': '**{}', '051': '{{}}', '052': 'for {} in {}:', '053': 'i', '108': 'makeOffspring', '109': 'self_location', '085': 'int', '049': '}}}}', '048': '{{{{', '102': 'index', '103': 'new_char_index', '045': '[{}]', '084': 'float', '043': '{} += {}', '042': 'translation', '041': 'aacid', '040': '({} + {})', '139': '{} is {}', '054': 'xrange', '151': 'organisms', '150': 'initiateInteraction', '176': 'other_friendliness', '074': '\\n', '047': 'replace', '152': 'other_name', '058': 'try:', '059': 'format', '179': 'acting_organism', '046': 'num_subacids', '177': 'friendliness', '155': 'message', '056': 'value', '174': 'kwargs', '050': 'count', '172': 'determineFriendliness', '171': 'print {}', '170': 'parsed_response', '044': 'new_container', '157': 'other_organism', '106': 'child_id', '175': 'get', '071': 'line', '145': 'stimulus_direction', '107': '0.75', '182': 'organism', '183': 'listdir', '180': 'dumps', '181': 'getAllOrganisms', '186': 'location', '187': 'nearby', '184': '-3', '185': 'findNearbyOrganisms', '188': '{} != {}', '189': 'organism_location', '061': 'except{}:', '060': '*{}', '063': 'return {}', '062': '#', '065': 'output', '064': 'translate', '067': 'while {}:', '066': 'code_list', '069': 'len', '068': '{} < {}', '190': '({} or {})', '168': 'full_response', '169': 'communicate', '164': 'stdout', '165': 'stderr', '166': 'universal_newlines', '167': 'True', '160': '{}={}', '161': 'bufsize', '162': 'stdin', '163': 'PIPE', '117': 'w', '116': 'open', '076': ':', '077': '({} * {})', '153': 'choice', '075': 'else:', '072': 'if {}:', '073': '{} == {}', '070': 'indent', '156': 'getMessage', '159': 'python', '158': 'Popen', '112': 'child_name', '078': ' ', '079': '4', '100': '0123456789abcdefghijklmnopqrstuvwxyz', '104': 'getChildId', '036': 'position', '118': 'write', '101': 'char_index', '146': '({} and {})', '147': '{} > {}', '144': 'shortest_distance', '088': 'parent_location', '142': 'distance_two', '143': 'abs', '140': 'distance_one', '141': 'min', '083': 'floatToInt', '082': 'max', '081': '{} -= {}', '080': '1', '087': 'getChildLocation', '086': 'round', '148': '{}{}', '149': '-shortest_distance', '003': 'random', '002': 'sys', '001': '{}, {}', '000': 'import {}', '007': 'numpy.random', '006': 'subprocess', '005': 'json', '004': 'os', '154': 'interact', '009': 'def {}({}):', '008': '', '120': 'str', '024': 'argv', '027': "'{}'", '026': 'split', '021': '{}[{}]', '125': '.'}
genome = '000001002001003001004001005001006007008009010008011012011013011014011015011016011017018012019018013020018014021022023021022023021023002024025026027028029026027030029018015022023004031008018016032018017033034008008009035036018037021038039036040036013018041021042037043036013018044045008018046022023022023022023041047001027048027008047001027049027008050027051052053022054046018055001056036022035036022023044057056034058018041022023041059060044034061008018041040027062041034063055001041036034008008009064008018065027008018066045008018036025067068036022069038018055001056036022035036022023066057056034018070025052071066072073022069071025043065027074034075072073021071029027076043065040040027074077027078077079070071043070080034075072073071027034081070080018070022082001070025034075043065040040027074077027078077079070071034034034034063065034008008009083084063022085022086001084025034008008009087088018088022085088018089022083022023023090003091001088092018089093089094063022095001089020034008008009096001097098018099027100018101022023099102097018103093022083022023023090003091001101098022069099063021099103034008008009104105018106027008052097105043106022096001097107034063106034008008009108008018055001109110022111014018089022087109018106022104110018112040040040089027113106027114018115022116001112027117022023115118040027119022120042022023115118040040040027074027121038027122022023115118022064008022023115123008034008008009111124018124021022023124026027125025063022023124026027113034008008009095001126127018126022120126052053022054128127022069126018126040027025126034063126034008008009129001036130063093040022085036130094034008008009131130011014018055001036132022111014018036022095001022129001036130020018133040040040036027113132027114022023004134001014133018014133034008008009135001018136137018138025072139136137018130022085022023023090003091001025012022131130034075018036022085021022111014025018140040128094022082001136036022141001136036018142022143128136036018144022141001140142072068136036018145029034075018145080034018130022085022023023090003091001077077145138012012072146147138025147022143130144072147130025018130144034075018130148149008034034022131130034034008008009150151018152022023003153151022154152034008008009154152018155022156008018157022023006158001045001027159152001160161080001160162023006163001160164023006163001160165023006163160166167018168022023157169155018170021168025171170034008008009172173174072022023174175027176018177077021174027176017034075018177022023023090003091001025080034063177034008008009156173174018155022178008018021155027179014018021155027177022172173174063022023005180155034008008009181015018151045008052182022023004183015072073021182039184008027114022023151057182034034063151034008008009185151018186022085021022111014025018187045008052182151072188182014018189022085021022111182025072190068022143128189186016147022143128189186128094016022023187057182034034034063187034008022010008018191022192008058018191022023005193191034061008018191022178008034072188022194191178018191022178008034072139022023191175027179137022135008018151022181015018187022185151072187022150187034022108008034075018157022023191175027179018195022085021022111157025018176022084022023191175027177022135001195176171022156001160157157160176176034'
import sys, random, os, json, subprocess, numpy.random

def getTraits():
    global metabolism
    global codon_length
    global self_name
    global world
    global sight_distance
    global neutrality
    metabolism = 20
    codon_length = 3
    self_name = sys.argv[0].split('\\')[-1].split('/')[-1]
    world = os.getcwd()
    sight_distance = 300
    neutrality = 0.5


def getTree(position):
    codon = genome[position:(position + codon_length)]
    aacid = translation[codon]
    position += codon_length
    new_container = []
    num_subacids = aacid.replace('{{', '').replace('}}', '').count('{}')
    for i in xrange(num_subacids):
        (value, position) = getTree(position)
        new_container.append(value)
    try:
        aacid = aacid.format(*new_container)
    except:
        aacid = ('#' + aacid)
    return (aacid, position)


def translate():
    output = ''
    code_list = []
    position = 0
    while position < len(genome):
        (value, position) = getTree(position)
        code_list.append(value)
    indent = 0
    for line in code_list:
        if len(line) == 0:
            output += '\n'
        else:
            if line[-1] == ':':
                output += (('\n' + (' ' * (4 * indent))) + line)
                indent += 1
            else:
                if line == 'dedent':
                    indent -= 1
                    indent = max(indent, 0)
                else:
                    output += (('\n' + (' ' * (4 * indent))) + line)
    return output


def floatToInt(float):
    return int(round(float, 0))


def getChildLocation(parent_location):
    parent_location = int(parent_location)
    child_location = floatToInt(numpy.random.normal(parent_location, 30))
    child_location = (child_location % 1000)
    return intToString(child_location, 3)


def mutateChar(char, mutability):
    chars = '0123456789abcdefghijklmnopqrstuvwxyz'
    char_index = chars.index(char)
    new_char_index = (floatToInt(numpy.random.normal(char_index, mutability)) % len(chars))
    return chars[new_char_index]


def getChildId(parent_id):
    child_id = ''
    for char in parent_id:
        child_id += mutateChar(char, 0.75)
    return child_id


def makeOffspring():
    (self_location, self_id) = splitName(self_name)
    child_location = getChildLocation(self_location)
    child_id = getChildId(self_id)
    child_name = (((child_location + '_') + child_id) + '.py')
    child = open(child_name, 'w')
    child.write(('translation = ' + str(translation)))
    child.write(((('\n' + 'genome = \"') + genome) + '\"'))
    child.write(translate())
    child.close()


def splitName(name):
    name = name.split('.')[0]
    return name.split('_')


def intToString(num, length):
    num = str(num)
    for i in xrange((length - len(num))):
        num = ('0' + num)
    return num


def getNewPosition(position, distance):
    return ((int(position) + distance) % 1000)


def move(distance):
    global self_name
    (position, unique_id) = splitName(self_name)
    position = intToString(getNewPosition(position, distance), 3)
    new_name = (((position + '_') + unique_id) + '.py')
    os.rename(self_name, new_name)
    self_name = new_name


def tryToMove(end_point = None, motivation = 0):
    if end_point is None:
        distance = int(numpy.random.normal(0, metabolism))
        move(distance)
    else:
        position = int(splitName(self_name)[0])
        distance_one = ((1000 - max(end_point, position)) + min(end_point, position))
        distance_two = abs((end_point - position))
        shortest_distance = min(distance_one, distance_two)
        if end_point < position:
            stimulus_direction = -1
        else:
            stimulus_direction = 1
        distance = int(numpy.random.normal(((stimulus_direction * motivation) * metabolism), metabolism))
        if (motivation > 0 and abs(distance) > shortest_distance):
            if distance > 0:
                distance = shortest_distance
            else:
                distance = -shortest_distance
        move(distance)


def initiateInteraction(organisms):
    other_name = random.choice(organisms)
    interact(other_name)


def interact(other_name):
    message = getMessage()
    other_organism = subprocess.Popen(['python', other_name], bufsize=1, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE, universal_newlines=True)
    full_response = other_organism.communicate(message)
    parsed_response = full_response[0]
    print parsed_response


def determineFriendliness(**kwargs):
    if kwargs.get('other_friendliness'):
        friendliness = (kwargs['other_friendliness'] * neutrality)
    else:
        friendliness = numpy.random.normal(0, 1)
    return friendliness


def getMessage(**kwargs):
    message = dict()
    message['acting_organism'] = self_name
    message['friendliness'] = determineFriendliness(**kwargs)
    return json.dumps(message)


def getAllOrganisms(world):
    organisms = []
    for organism in os.listdir(world):
        if organism[-3:] == '.py':
            organisms.append(organism)
    return organisms


def findNearbyOrganisms(organisms):
    location = int(splitName(self_name)[0])
    nearby = []
    for organism in organisms:
        if organism != self_name:
            organism_location = int(splitName(organism)[0])
            if (abs((organism_location - location)) < sight_distance or abs((organism_location - location)) > (1000 - sight_distance)):
                nearby.append(organism)
    return nearby

getTraits()
start_conditions = raw_input()
try:
    start_conditions = json.loads(start_conditions)
except:
    start_conditions = dict()
if type(start_conditions) != dict:
    start_conditions = dict()
if start_conditions.get('acting_organism') is None:
    tryToMove()
    organisms = getAllOrganisms(world)
    nearby = findNearbyOrganisms(organisms)
    if nearby:
        initiateInteraction(nearby)
    makeOffspring()
else:
    other_organism = start_conditions.get('acting_organism')
    other_location = int(splitName(other_organism)[0])
    other_friendliness = float(start_conditions.get('friendliness'))
    tryToMove(other_location, other_friendliness)
    print getMessage(other_organism=other_organism, other_friendliness=other_friendliness)