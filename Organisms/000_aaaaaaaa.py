translation = {'098': '_', '099': '.py', '126': 'motivation', '090': 'range', '091': 'choice', '092': 'makeOffspring', '093': 'location_id', '094': 'unique_id', '095': '8', '096': 'alphanumeric', '097': 'offspring_name', '133': 'organisms', '132': 'initiateInteraction', '012': 'codon_length', '130': '-20', '014': 'world', '015': 'sight_distance', '135': 'interact', '134': 'other_name', '018': '3', '019': '{}[{}]', '139': 'other_organism', '138': 'getMessage', '127': '({} or {})', '120': 'uniqueID', '121': 'new_name', '027': '-1', '123': 'tryToMove', '021': '{}.{}', '020': '{}({})', '023': '0', '022': 'argv', '128': '{} is {}', '129': 'uniform', '029': 'getcwd', '028': '/', '010': 'global {}', '011': 'metabolism', '131': '20', '013': 'self_name', '137': 'message', '136': 'otherName', '016': '{} = {}', '084': 'chars', '017': '0.5', '144': 'stdin', '115': 'distance', '114': 'getNewPosition', '038': 'aacid', '039': 'translation', '111': 'intToString', '110': 'name', '113': '({} - {})', '112': 'num', '032': 'getTree', '033': 'position', '030': '300', '031': 'dedent', '119': 'move', '037': '({} + {})', '034': 'codon', '035': 'genome', '051': 'xrange', '171': 'get', '170': 'type', '108': 'close', '109': 'splitName', '148': 'universal_newlines', '049': 'for {} in {}:', '048': '{{}}', '102': 'w', '046': '}}}}', '045': '{{{{', '044': 'replace', '043': 'num_subacids', '107': '\\"', '104': 'translation = ', '040': '{} += {}', '151': 'communicate', '150': 'full_response', '153': 'dict', '047': 'count', '152': 'parsed_response', '058': 'except{}:', '059': '#', '103': 'write', '054': 'append', '055': 'try:', '056': 'format', '057': '*{}', '050': 'i', '172': 'print {}', '052': '({})', '073': ':', '101': 'open', '157': 'organism', '106': 'genome = \\"', '071': '\\n', '042': '[{}]', '041': 'new_container', '105': 'str', '061': 'translate', '060': 'return {}', '063': 'code_list', '062': 'output', '065': '{} < {}', '064': 'while {}:', '067': 'indent', '066': 'len', '069': 'if {}:', '068': 'line', '168': 'raw_input', '169': 'loads', '164': 'organism_location', '165': 'abs', '166': '{} > {}', '167': 'start_conditions', '160': 'findNearbyOrganisms', '161': 'location', '162': 'nearby', '163': '{} != {}', '117': 'int', '116': '({} % {})', '076': '4', '077': '1', '074': '({} * {})', '075': ' ', '155': 'dumps', '154': 'acting_organism', '070': '{} == {}', '156': 'getAllOrganisms', '159': '-3', '158': 'listdir', '078': '{} -= {}', '079': 'max', '100': 'offspring', '088': '0123456789abcdefghijklmnopqrstuvwxyz', '036': '{}:{}', '072': 'else:', '118': '1000', '053': 'value', '146': 'stdout', '147': 'stderr', '089': 'string', '145': 'PIPE', '142': '{}={}', '143': 'bufsize', '140': 'Popen', '141': 'python', '083': 'letters', '082': 'kind', '081': 'length', '080': 'getRandomString', '087': '0123456789', '086': 'numbers', '085': 'abcdefghijklmnopqrstuvwxyz', '149': 'True', '003': 'random', '002': 'sys', '001': '{}, {}', '000': 'import {}', '007': '', '006': 'subprocess', '005': 'json', '004': 'os', '009': 'getTraits', '008': 'def {}({}):', '025': "'{}'", '024': 'split', '122': 'rename', '026': '\\\\', '124': 'end_point', '125': 'None'}
genome = '000001002001003001004001005006007008009007010011010012010013010014010015016011017016012018016013019020021019020021019021002022023024025026027024025028027016014020021004029007016015030031007008032033016034019035036033037033012016038019039034040033012016041042007016043020021020021020021038044001025045025007044001025046025007047025048049050020051043016052001053033020032033020021041054053031055016038020021038056057041031058007016038037025059038031060052001038033031007008061007016062025007016063042007016033023064065033020066035016052001053033020032033020021063054053031016067023049068063069070020066068023040062025071031072069070019068027025073040062037037025071074025075074076067068040067077031072069070068025031078067077016067020079001067023031072040062037037025071074025075074076067068031031031031060062031007008080001081082069070082025083016084025085031072069070082025086016084025087031072016084025088031031016089025007049050020090081040089020021003091084031060089031007008092007016093020080001018025086016094020080001095025096016097037037037093025098094025099016100020101001097025102020021100103037025104020105039020021100103037037037025071025106035025107020021100103020061007020021100108007031007008109110060020021110024025098031007008111001112081016112020105112049050020051113081020066112016112037025023112031060112031007008114001033115060116037020117033115118031007008119115010013016052001033120020021013024025098016033020111001020114001033115018016121037037033025098120020021004122001013121016013121031007008123001016124125016126023069127128124125070126023016115020117074020021003129001130131011020119115031031007008132133016134020021003091133020135134031007008135136016137020138007016139020021006140001042001025141136001142143077001142144021006145001142146021006145001142147021006145142148149016150020021139151137016152019150023031007008138007016137020153007016019137025154013060020021005155137031007008156014016133042007049157020021004158014069070019157036159007025099020021133054157031031060133031007008160133016161020117019020109013023016162042007049157133069163157013016164020117019020109157023069127065020165113164161015166020165113164161113118015020021162054157031031031060162031020009007016167020168007055016167020021005169167031058007016167020153007031069163020170167153016167020153007031069128020021167171025154125020123007016133020156014016162020160133069162020132162031020092007031072020123007172020138007031'
import sys, random, os, json, subprocess

def getTraits():
    global metabolism
    global codon_length
    global self_name
    global world
    global sight_distance
    metabolism = 0.5
    codon_length = 3
    self_name = sys.argv[0].split('\\')[-1].split('/')[-1]
    world = os.getcwd()
    sight_distance = 300

def getTree(position):
    codon = genome[position:(position + codon_length)]
    aacid = translation[codon]
    position += codon_length
    new_container = []
    num_subacids = aacid.replace('{{', '').replace('}}', '').count('{}')
    for i in xrange(num_subacids):
        (value, position) = getTree(position)
        new_container.append(value)
    try:
        aacid = aacid.format(*new_container)
    except:
        aacid = ('#' + aacid)
    return (aacid, position)

def translate():
    output = ''
    code_list = []
    position = 0
    while position < len(genome):
        (value, position) = getTree(position)
        code_list.append(value)
    indent = 0
    for line in code_list:
        if len(line) == 0:
            output += '\n'
        else:
            if line[-1] == ':':
                output += (('\n' + (' ' * (4 * indent))) + line)
                indent += 1
            else:
                if line == 'dedent':
                    indent -= 1
                    indent = max(indent, 0)
                else:
                    output += (('\n' + (' ' * (4 * indent))) + line)
    return output

def getRandomString(length, kind):
    if kind == 'letters':
        chars = 'abcdefghijklmnopqrstuvwxyz'
    else:
        if kind == 'numbers':
            chars = '0123456789'
        else:
            chars = '0123456789abcdefghijklmnopqrstuvwxyz'
    string = ''
    for i in range(length):
        string += random.choice(chars)
    return string

def makeOffspring():
    location_id = getRandomString(3, 'numbers')
    unique_id = getRandomString(8, 'alphanumeric')
    offspring_name = (((location_id + '_') + unique_id) + '.py')
    offspring = open(offspring_name, 'w')
    offspring.write(('translation = ' + str(translation)))
    offspring.write(((('\n' + 'genome = \"') + genome) + '\"'))
    offspring.write(translate())
    offspring.close()

def splitName(name):
    return name.split('_')

def intToString(num, length):
    num = str(num)
    for i in xrange((length - len(num))):
        num = ('0' + num)
    return num

def getNewPosition(position, distance):
    return ((int(position) + distance) % 1000)

def move(distance):
    global self_name
    (position, uniqueID) = self_name.split('_')
    position = intToString(getNewPosition(position, distance), 3)
    new_name = ((position + '_') + uniqueID)
    os.rename(self_name, new_name)
    self_name = new_name

def tryToMove(end_point = None, motivation = 0):
    if (end_point is None or motivation == 0):
        distance = int((random.uniform(-20, 20) * metabolism))
        move(distance)

def initiateInteraction(organisms):
    other_name = random.choice(organisms)
    interact(other_name)

def interact(otherName):
    message = getMessage()
    other_organism = subprocess.Popen(['python', otherName], bufsize=1, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE, universal_newlines=True)
    full_response = other_organism.communicate(message)
    parsed_response = full_response[0]

def getMessage():
    message = dict()
    message['acting_organism'] = self_name
    return json.dumps(message)

def getAllOrganisms(world):
    organisms = []
    for organism in os.listdir(world):
        if organism[-3:] == '.py':
            organisms.append(organism)
    return organisms

def findNearbyOrganisms(organisms):
    location = int(splitName(self_name)[0])
    nearby = []
    for organism in organisms:
        if organism != self_name:
            organism_location = int(splitName(organism)[0])
            if (abs((organism_location - location)) < sight_distance or abs((organism_location - location)) > (1000 - sight_distance)):
                nearby.append(organism)
    return nearby
getTraits()
start_conditions = raw_input()
try:
    start_conditions = json.loads(start_conditions)
except:
    start_conditions = dict()
if type(start_conditions) != dict:
    start_conditions = dict()
if start_conditions.get('acting_organism') is None:
    tryToMove()
    organisms = getAllOrganisms(world)
    nearby = findNearbyOrganisms(organisms)
    if nearby:
        initiateInteraction(nearby)
    makeOffspring()
else:
    tryToMove()
    print getMessage()