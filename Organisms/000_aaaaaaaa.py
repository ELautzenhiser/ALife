translation = {'098': '8', '099': 'alphanumeric', '023': '{}.{}', '090': '0123456789', '091': '0123456789abcdefghijklmnopqrstuvwxyz', '092': 'string', '093': 'range', '094': 'choice', '095': 'makeOffspring', '096': 'location_id', '097': 'unique_id', '133': 'distance_one', '011': 'global {}', '131': 'numpy', '013': 'codon_length', '137': 'shortest_distance', '015': 'world', '016': 'sight_distance', '017': 'neutrality', '018': '{} = {}', '019': '20', '139': '({} and {})', '138': 'stimulus_direction', '127': 'end_point', '025': '0', '024': 'argv', '122': 'move', '123': 'uniqueID', '124': 'new_name', '020': '3', '126': 'tryToMove', '022': '{}({})', '128': 'None', '129': 'motivation', '029': '-1', '028': '\\\\', '010': 'getTraits', '132': 'normal', '012': 'metabolism', '130': '{} is {}', '014': 'self_name', '136': 'abs', '135': 'distance_two', '134': 'min', '089': 'numbers', '115': 'num', '114': 'intToString', '038': 'genome', '039': '{}:{}', '111': 'close', '110': '\\"', '113': 'name', '055': '({})', '032': '300', '033': '0.5', '030': '/', '031': 'getcwd', '119': '({} % {})', '037': 'codon', '034': 'dedent', '035': 'getTree', '174': 'organism', '050': 'count', '051': '{{}}', '052': 'for {} in {}:', '053': 'i', '108': 'str', '109': 'genome = \\"', '085': 'kind', '049': '}}}}', '048': '{{{{', '102': '.py', '046': 'num_subacids', '045': '[{}]', '101': '_', '043': '{} += {}', '107': 'translation = ', '041': 'aacid', '040': '({} + {})', '054': 'xrange', '076': ':', '150': 'Popen', '153': 'bufsize', '047': 'replace', '152': '{}={}', '058': 'try:', '059': 'format', '179': 'nearby', '178': 'location', '177': 'findNearbyOrganisms', '176': '-3', '056': 'value', '057': 'append', '173': 'getAllOrganisms', '172': 'dumps', '171': 'acting_organism', '170': 'dict', '044': 'new_container', '070': 'indent', '106': 'write', '175': 'listdir', '156': 'stdout', '145': 'other_name', '042': 'translation', '182': '({} or {})', '183': 'start_conditions', '180': '{} != {}', '181': 'organism_location', '186': 'type', '187': 'other_location', '184': 'raw_input', '185': 'loads', '188': 'float', '105': 'w', '061': 'except{}:', '060': '*{}', '063': 'return {}', '062': '#', '065': 'output', '064': 'translate', '067': 'while {}:', '066': 'code_list', '069': 'len', '068': '{} < {}', '168': 'other_friendliness', '169': 'friendliness', '164': 'determineFriendliness', '165': '**{}', '166': 'kwargs', '167': 'get', '160': 'full_response', '161': 'communicate', '162': 'parsed_response', '163': 'print {}', '117': 'getNewPosition', '116': '({} - {})', '103': 'offspring', '151': 'python', '077': '({} * {})', '074': '\\n', '075': 'else:', '072': 'if {}:', '073': '{} == {}', '157': 'stderr', '071': 'line', '159': 'True', '158': 'universal_newlines', '112': 'splitName', '078': ' ', '079': '4', '100': 'offspring_name', '104': 'open', '149': 'other_organism', '036': 'position', '118': 'distance', '155': 'PIPE', '146': 'interact', '147': 'message', '144': 'organisms', '088': 'abcdefghijklmnopqrstuvwxyz', '142': '-shortest_distance', '143': 'initiateInteraction', '140': '{} > {}', '141': '{}{}', '083': 'getRandomString', '082': 'max', '081': '{} -= {}', '080': '1', '087': 'chars', '086': 'letters', '148': 'getMessage', '084': 'length', '003': 'random', '002': 'sys', '001': '{}, {}', '000': 'import {}', '007': 'numpy.random', '006': 'subprocess', '005': 'json', '004': 'os', '154': 'stdin', '009': 'def {}({}):', '008': '', '120': 'int', '121': '1000', '027': "'{}'", '026': 'split', '021': '{}[{}]', '125': 'rename'}
genome = '000001002001003001004001005001006007008009010008011012011013011014011015011016011017018012019018013020018014021022023021022023021023002024025026027028029026027030029018015022023004031008018016032018017033034008008009035036018037021038039036040036013018041021042037043036013018044045008018046022023022023022023041047001027048027008047001027049027008050027051052053022054046018055001056036022035036022023044057056034058018041022023041059060044034061008018041040027062041034063055001041036034008008009064008018065027008018066045008018036025067068036022069038018055001056036022035036022023066057056034018070025052071066072073022069071025043065027074034075072073021071029027076043065040040027074077027078077079070071043070080034075072073071027034081070080018070022082001070025034075043065040040027074077027078077079070071034034034034063065034008008009083001084085072073085027086018087027088034075072073085027089018087027090034075018087027091034034018092027008052053022093084043092022023003094087034063092034008008009095008018096022083001020027089018097022083001098027099018100040040040096027101097027102018103022104001100027105022023103106040027107022108042022023103106040040040027074027109038027110022023103106022064008022023103111008034008008009112113063022023113026027101034008008009114001115084018115022108115052053022054116084022069115018115040027025115034063115034008008009117001036118063119040022120036118121034008008009122118011014018055001036123022112014018036022114001022117001036118020018124040040036027101123022023004125001014124018014124034008008009126001018127128018129025072130127128018118022120022023023131003132001025012022122118034075018036022120021022112014025018133040116121022082001127036022134001127036018135022136116127036018137022134001133135072068127036018138029034075018138080034018118022120022023023131003132001077077138129012012072139140129025140022136118137072140118025018118137034075018118141142008034034022122118034034008008009143144018145022023003094144022146145034008008009146145018147022148008018149022023006150001045001027151145001152153080001152154023006155001152156023006155001152157023006155152158159018160022023149161147018162021160025163162034008008009164165166072022023166167027168018169077021166027168017034075018169022023023131003132001025080034063169034008008009148165166018147022170008018021147027171014018021147027169022164165166063022023005172147034008008009173015018144045008052174022023004175015072073021174039176008027102022023144057174034034063144034008008009177144018178022120021022112014025018179045008052174144072180174014018181022120021022112174025072182068022136116181178016140022136116181178116121016022023179057174034034034063179034008022010008018183022184008058018183022023005185183034061008018183022170008034072180022186183170018183022170008034072130022023183167027171128022126008018144022173015018179022177144072179022143179034022095008034075018149022023183167027171018187022120021022112149025018168022188022023183167027169022126001187168163022148001152149149152168168034'
import sys, random, os, json, subprocess, numpy.random

def getTraits():
    global metabolism
    global codon_length
    global self_name
    global world
    global sight_distance
    global neutrality
    metabolism = 20
    codon_length = 3
    self_name = sys.argv[0].split('\\')[-1].split('/')[-1]
    world = os.getcwd()
    sight_distance = 300
    neutrality = 0.5


def getTree(position):
    codon = genome[position:(position + codon_length)]
    aacid = translation[codon]
    position += codon_length
    new_container = []
    num_subacids = aacid.replace('{{', '').replace('}}', '').count('{}')
    for i in xrange(num_subacids):
        (value, position) = getTree(position)
        new_container.append(value)
    try:
        aacid = aacid.format(*new_container)
    except:
        aacid = ('#' + aacid)
    return (aacid, position)


def translate():
    output = ''
    code_list = []
    position = 0
    while position < len(genome):
        (value, position) = getTree(position)
        code_list.append(value)
    indent = 0
    for line in code_list:
        if len(line) == 0:
            output += '\n'
        else:
            if line[-1] == ':':
                output += (('\n' + (' ' * (4 * indent))) + line)
                indent += 1
            else:
                if line == 'dedent':
                    indent -= 1
                    indent = max(indent, 0)
                else:
                    output += (('\n' + (' ' * (4 * indent))) + line)
    return output


def getRandomString(length, kind):
    if kind == 'letters':
        chars = 'abcdefghijklmnopqrstuvwxyz'
    else:
        if kind == 'numbers':
            chars = '0123456789'
        else:
            chars = '0123456789abcdefghijklmnopqrstuvwxyz'
    string = ''
    for i in range(length):
        string += random.choice(chars)
    return string


def makeOffspring():
    location_id = getRandomString(3, 'numbers')
    unique_id = getRandomString(8, 'alphanumeric')
    offspring_name = (((location_id + '_') + unique_id) + '.py')
    offspring = open(offspring_name, 'w')
    offspring.write(('translation = ' + str(translation)))
    offspring.write(((('\n' + 'genome = \"') + genome) + '\"'))
    offspring.write(translate())
    offspring.close()


def splitName(name):
    return name.split('_')


def intToString(num, length):
    num = str(num)
    for i in xrange((length - len(num))):
        num = ('0' + num)
    return num


def getNewPosition(position, distance):
    return ((int(position) + distance) % 1000)


def move(distance):
    global self_name
    (position, uniqueID) = splitName(self_name)
    position = intToString(getNewPosition(position, distance), 3)
    new_name = ((position + '_') + uniqueID)
    os.rename(self_name, new_name)
    self_name = new_name


def tryToMove(end_point = None, motivation = 0):
    if end_point is None:
        distance = int(numpy.random.normal(0, metabolism))
        move(distance)
    else:
        position = int(splitName(self_name)[0])
        distance_one = ((1000 - max(end_point, position)) + min(end_point, position))
        distance_two = abs((end_point - position))
        shortest_distance = min(distance_one, distance_two)
        if end_point < position:
            stimulus_direction = -1
        else:
            stimulus_direction = 1
        distance = int(numpy.random.normal(((stimulus_direction * motivation) * metabolism), metabolism))
        if (motivation > 0 and abs(distance) > shortest_distance):
            if distance > 0:
                distance = shortest_distance
            else:
                distance = -shortest_distance
        move(distance)


def initiateInteraction(organisms):
    other_name = random.choice(organisms)
    interact(other_name)


def interact(other_name):
    message = getMessage()
    other_organism = subprocess.Popen(['python', other_name], bufsize=1, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE, universal_newlines=True)
    full_response = other_organism.communicate(message)
    parsed_response = full_response[0]
    print parsed_response


def determineFriendliness(**kwargs):
    if kwargs.get('other_friendliness'):
        friendliness = (kwargs['other_friendliness'] * neutrality)
    else:
        friendliness = numpy.random.normal(0, 1)
    return friendliness


def getMessage(**kwargs):
    message = dict()
    message['acting_organism'] = self_name
    message['friendliness'] = determineFriendliness(**kwargs)
    return json.dumps(message)


def getAllOrganisms(world):
    organisms = []
    for organism in os.listdir(world):
        if organism[-3:] == '.py':
            organisms.append(organism)
    return organisms


def findNearbyOrganisms(organisms):
    location = int(splitName(self_name)[0])
    nearby = []
    for organism in organisms:
        if organism != self_name:
            organism_location = int(splitName(organism)[0])
            if (abs((organism_location - location)) < sight_distance or abs((organism_location - location)) > (1000 - sight_distance)):
                nearby.append(organism)
    return nearby

getTraits()
start_conditions = raw_input()
try:
    start_conditions = json.loads(start_conditions)
except:
    start_conditions = dict()
if type(start_conditions) != dict:
    start_conditions = dict()
if start_conditions.get('acting_organism') is None:
    tryToMove()
    organisms = getAllOrganisms(world)
    nearby = findNearbyOrganisms(organisms)
    if nearby:
        initiateInteraction(nearby)
    makeOffspring()
else:
    other_organism = start_conditions.get('acting_organism')
    other_location = int(splitName(other_organism)[0])
    other_friendliness = float(start_conditions.get('friendliness'))
    tryToMove(other_location, other_friendliness)
    print getMessage(other_organism=other_organism, other_friendliness=other_friendliness)